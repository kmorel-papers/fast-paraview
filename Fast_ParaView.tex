\documentclass{IEEEcsmag}


\usepackage[colorlinks,urlcolor=blue,linkcolor=blue,citecolor=blue]{hyperref}

\usepackage{upmath}

\jvol{XX}
\jnum{XX}
\paper{8}
\jmonth{May/June}
\jname{IT Professional}
\pubyear{2024}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}


\setcounter{secnumdepth}{0}

\graphicspath{{pics/}}

\hyphenation{Para-View}

\usepackage{color}
\newcommand*{\fix}[1]{\textbf{\emph{\textcolor{red}{#1}}}}

\definecolor{km}{RGB}{105, 41, 197}
\definecolor{fs}{RGB}{17, 146, 233}

\newcommand*{\km}[1]{\textcolor{km}{\emph{\textbf{#1} -- KM}}}
\newcommand*{\fs}[1]{\textcolor{fs}{\emph{\textbf{#1} -- FS}}}

\usepackage{booktabs}
\usepackage{paralist}
\usepackage{subcaption}
\usepackage{xspace}

\newcommand*{\colormap}[1]{\textsl{#1}\xspace}
\newcommand*{\huewheel}{\colormap{Hue Wheel}}
\newcommand*{\coolwarm}{\colormap{Cool to Warm}}
\newcommand*{\blueorange}{\colormap{Blue-Orange Diverging}}
\newcommand*{\fast}{\colormap{Fast}}
\newcommand*{\turbo}{\colormap{Turbo}}
\newcommand*{\extendedcoolwarm}{\colormap{Extended Cool Warm}}

\begin{document}

\sptitle{DEPARTMENT: Visualization Viewpoints}

\title{A New Default Colormap for ParaView}

\author{Francesca Samsel}
\affil{Texas Advanced Computing Center, University of Texas at Austin, Austin, TX, 78759, USA}

\author{W. Alan Scott}
\affil{Sandia National Laboratories, Albuquerque, NM, 87123, USA}

\author{Kenneth Moreland}
\affil{Oak Ridge National Laboratory, Oak Ridge, TN, 37831, USA}

\markboth{Theresa-Marie Rhyne}{Theresa-Marie Rhyne}



\begin{abstract}
%\looseness-1
ParaView is one of the most prominent software tools for scientific visualization used by scientists around the world.
Color is a primary conduit to visually map data to its representation and thus enable investigation and interpretation of the data.
Colormap selection has a significant impact on the data revealed; its design and selection is a critical aspect of scientific data visualization.
A common choice for a user is the program's default colormap, so careful consideration of this default is consequential.
Although the current default colormap in ParaView, a succession of hues from cool blue to warm red, has served the community well, research shows that more nuanced colormap configurations increase discriminability while maintaining other critical metrics.
These findings inspire us to revisit and update the default colors in ParaView.
Here we present a new ParaView default colormap, the criteria and methods of development, and example visualizations and analytic metrics.
\end{abstract}

\maketitle

\chapteri{T}he colormap is a critical part of any pseudocolor visualization.
A colormap is a simple function that maps numbers to colors, which can then be applied to visually categorize data, highlight data, or represent a continuous distribution of values over a surface or volume.
The colormap is most recognizable to users as a bar painted with a transition of colors representing a range of numbers from low to high.
When presented with these colors, a viewer makes determinations of the values represented by these numbers and the patterns they form.
The efficacy of a pseudocolor visualization depends on a person's ability to perceive and translate these colors.

Ideally, each visualization would have a colormap tailored to the specifics of its data, tasks, and audience, but this is usually impractical.
A typical user is unlikely to be a color expert, so it is imperative that the visualization system provide sound options that accurately and impartially represent the data. It is particularly important to have a good default colormap that is used in the absence of any further configuration. Many users will have neither the inclination nor the proficiency to change the default colors selected by the visualization system.


\begin{figure*}[htb]
\centering
\includegraphics[width=\textwidth]{Final_Pics/Larsen_the3.png}
\caption{Paraview's first default colormap was the \huewheel, left, which was improved upon with the adoption of \coolwarm, center. The new default, \fast, is on the right. All are shown on combustion data, \cite{Larsen}, illustrating the improving feature resolution power progression}.
\label{Larsen3}
\end{figure*}

Here we present the new default colormap design for Paraview, a scientific visualization software application used throughout the scientific community to visualize large, complex datasets in both 2D and 3D space. The authors of this paper are longtime contributors to the ParaView scientific visualization application~\cite{Ahrens2005}.

Default colormaps must balance the needs of many users. This raises distinct challenges for colormap construction in ParaView and similar scientific visualizaton software.
Care has been taken to choose colors and colormaps in ParaView that work well in a variety of contexts.
Because ParaView supports switching among these views or multiple views together and because ParaView keeps colors consistent across them for clarity, the default colors must be adept when displayed in any of these contexts.
This paper describes the criteria and rationale behind the construction choices in the new default colormap in ParaView.
The criteria and specific changes stem from over a decade of collaboration with scientists at Los Alamos National Laboratory, Sandia National Laboratories, and other institutions.

Early versions of ParaView used the \huewheel, shown on the left in Figure~\ref{Larsen3}, as the default colormap.
This colormap is formed by interpolating along the hues, typically from blue to red, in the HSV color space.
(Note that this colormap is often referred to as the ``Rainbow'' colormap, but we avoid that name to remove confusion with other maps designed with colors from the rainbow.)
\huewheel is a common choice as it is the simplest way to program a sequence of many vibrant colors.
Although the criticisms of the \huewheel colormap were known even at the inception of the ParaView software~\cite{Rogowitz1998}, there were few practical alternatives.

It was when Borland and Taylor~\cite{Borland2007} admonished ParaView and other visualization programs that the developers became motivated to improve their default colormap design.
After adapting the best recommendations available at the time and drawing inspiration from the GIS community, which had extensive color map recommendations~\cite{Brewer2003}, the team settled on a \coolwarm colormap design~\cite{Moreland2009} shown in the center panel of Figure~\ref{Larsen3}.
This map adopts a diverging colormap approach with a smoothed luminance profile in the transition between hues.
Since the introduction of the \coolwarm colormap as the default in ParaView, many practitioners have proposed alternate maps~\cite{Samsel2015}, and multiple perceptual studies have been conducted to evaluate these colormaps~\cite{Ware2017}.
Some show that the \coolwarm colormap performs less well than its alternatives, particularly with respect to its discriminability~\cite{Ware2017,Ware2019}.
Consequently, the ParaView development team has been motivated to revisit its default colormap.

This paper describes the processes we undertook to design a new default colormap for ParaView, which we dub ``\fast'', shown on the right side of Figure~\ref{Larsen3}.
We describe the criteria we used in designing this colormap: the iterative design process; refining the hue selection; smoothing the transitions; distributing the final colormap to get feedback from current users; evaluation using perceptual models; and making the final refinements.

\begin{figure}[t]
  \begin{subfigure}{\linewidth}
    \includegraphics[width=\linewidth]{map-cool-to-warm}
    \vspace{-1.4\baselineskip}
    \caption{Original \coolwarm coolwarm.}
    \label{fig:design:coolwarm}
  \end{subfigure}\\[4pt]
  \begin{subfigure}{\linewidth}
    \includegraphics[width=\linewidth]{Final_Pics/CW_extended.png}
    \vspace{-1.4\baselineskip}
    \caption{\extendedcoolwarm colormap.}
    \label{fig:design:cw est}
  \end{subfigure}\\[4pt]
  \begin{subfigure}{\linewidth}
    \includegraphics[width=\linewidth]{map-blue-orange-diverging}
    \vspace{-1.4\baselineskip}
    \caption{\blueorange colormap.}
    \label{fig:design:blueorange}
  \end{subfigure}\\[4pt]
  \begin{subfigure}{\linewidth}
    \includegraphics[width=\linewidth]{map-fast}
    \vspace{-1.4\baselineskip}
    \caption{Final \fast colormap.}
    \label{fig:design:fast}
  \end{subfigure}
  \caption{
    Transition of the default ParaView color map from the original (top) variations designed to improve discriminatory power to the new default (bottom) colormap.
  }
  \label{fig:designs}
\end{figure}

\section{CRITERIA}

There are many guidelines for colormaps proposed in the literature. We use the collection compiled by Bujack et al.~\cite{Bujack2018} as a guide. The characteristics most important to us, in no particular order, are as follows.

\begin{itemize}

\item \emph{Discriminative power} --
  We wish to maximize the number of just noticeable differences in the colormap to make subtle differences visible.
\item \emph{Uniformity} --
  The perceptual difference between colors should be commensurate with the difference in the numbers they represent.
\item \emph{Smoothness} --
  The rate of change of coloring should be uniform along with the difference in colors themselves.
  This is particularly important for the luminance profile where a sharp change from increasing to decreasing brightness can cause undesired bands.
\item \emph{Order} --
  The color sequence should have an easy to intuit, or at least easy to remember, progression from low to high values.
  The colors should follow natural interpretations and accepted conventions where possible.
\item \emph{Robustness to shading on 3D surfaces} -- Shading, which darkens a surface based on its orientation with respect to the light source and viewer, is vital in perceiving shape.
  If a surface is painted with overly dark colors, the shading becomes indiscernible.
  %as can be seen in Figure~\ref{fig:3d-shading}.
\item \emph{Robustness to colorblindness} --
  The colors should be distinguishable for the many users with various types and degrees of colorblindness.
\item \emph{Aesthetically pleasing} --
  Although quite subjective, ParaView users should generally be pleased with the new colors.

\end{itemize}
These critera are not independent improvements as changes in one property could degrade the effectiveness in others.
The color theory section below details relevant artistic color theory principles which drove the construction of \fast, shown in Figure~\ref{fig:designs}. 

%For example, issues with order, 3D surfaces, or colorblindess are typically resolved by limiting the colors used, but reducing the number of colors lowers the discriminative power of the map. Consequently, there is no such thing as the perfect color map. Our default colormap needs to be a jack of all trades even if it is a master at none.

\begin{figure}
\includegraphics[width=\linewidth]{pics/Ware17.png}
\caption{This chart by Ware et al. \cite{Ware2017} illustrates the discriminatory at points across the colormap. The abbreviations, left to right: RA - \huewheel; CW - \coolwarm; ECW - \extendedcoolwarm; BOD = \blueorange; VI - \colormap{Viridis}; GP - \colormap{Grayscale}; GR - \colormap{Green-Red}. }
\label{Ware}
\end{figure}


\section {COLORMAPS \& ARTISTIC COLOR THEORY}

Colormaps come in a wide variety, categorized loosely by their luminance distribution and number of ramps.
%and designed to address different visualization tasks, data distributions as well as the needs and conventions of the science domain.
General categories include discrete, linear, diverging, isoluminent, and more custom constructions such as wave maps.
Discrete colormaps contain specific hues without interpolation between hues.
Linear maps, colormaps that span one value ramp, enable intuitive identification of scalar values and equalized attention across the visualization but contain lower discriminatory power due to the monotonic luminance profile ramp and a narrow range of hues.
Diverging maps are colormaps that contain two abutting value ramps, which provides addition discriminatory power.
\coolwarm, \blueorange, and \fast are all examples of diverging maps.
Isolumient colormaps hold advantages for specific uses but suffer from low discriminatory power as by definition they seek to limit the luminance range as shown in Figure~\ref{Ware}.

As a base for our discussion, it will be helpful to understand a bit about Artistic Color Contrast Theory \cite{Itten, Albers}. Artistic Color Contrast Theory, the foundation of painting since the Renaissance, is a set of principles that drive the characteristics and interactions and of colors. The principles center on the seven types of color contrast~\cite{Itten}.
The first three are
\begin{inparaenum}[(1)]
\item contrast of hue,
\item contrast of saturation, and
\item contrast of luminance, which are familiar as they align with parameters of HSL and other color spaces.
Two more are
\item cool-warm contrast and
\item complimentary contrast, both of which involve colors on opposite sides of the color wheel.
The remaining two are
\item simultaneous contrast at play in the \huewheel colormap and
\item contrast of extension, which speaks to balance of the area covered by specific hues.
\end{inparaenum}

\begin{figure*}[t]
\centering
\includegraphics[width=\textwidth]{Final_Pics/HSVV.png}
\caption{This set of visualizations illustrates the impacts on \coolwarm when the value, saturation and hue are extended to their full range. Left: \coolwarm, \coolwarm with the luminance extended to black; \coolwarm with the saturation spanning into full saturation at the ends of the coolormap; hue, spanning through cool and warm colors with the same luminance and saturation values as \coolwarm; and \fast which balances luminance, saturation and hue ranges in order to best meet the colormap criteria.}

\label{contrast}
\end{figure*}

Colormaps translate data, not through the colors themselves, but through the \textit{contrast} between perceivable colors within the colormap. In discrete colormaps it is the contrast between the individual colors that reveals the data. Scalar colormaps are smooth ramps generated by selecting a set of control points and then interpolating between the control points in CIELAB colorspace. The discriminatory power in a colormap relies on the contrast across its entire path through colorspace, which includes both the control points and the colors on the path through color space.

Figure~\ref{contrast} illustrates three types of color contrast as applied to data from a simulation of bow waves in Ganymede's magnetosphere.
%The data range is clipped to concentrate the contrast in the bow waves, which is the area of interest.
%The figure contains three diverging colormaps to illustrate specific types of contrast: luminance, saturation, and hue.
The figure takes the \coolwarm colormap and dramatically increases the luminance contrast, saturation contrast, and hue contrast, respectively.
%The hue contrast is between red and blue; saturated, warm hues against a muted tan hue; luminance, black and white.
%On right, multiple types on contrasts are combined: hue, the range of cool colors in the blue green ramp; saturation, the saturated cool hues with the muted tan hue; luminance, the dark greens and blues against the light tan; and a subtle cool warm contrast between the cool blue to green range and the warm yellow tan in the upper range.
%The luminance alone provides clear differentiation of the large features but does not capture the nuance shown in the saturation contrast example.
Each increase in contrast demonstrates greater detail than the original \coolwarm it comes from.
However, having such dramatic contrast can interfere with other elements of a display such as shading, background, and labeling.
Figure~\ref{contrast} shows at right how the \fast colormap combines more subtle versions of all these types of contrast to achieve the same improvement without dominating color features.

%\km{I am thoroughly confused by this description. The description in the text does not match the description in the caption. Is this meant to say that the first image shows hue contrast, the second saturation contrast, etc.? If so, how is the left image not also showing, say, cool-warm contrast? Why is the third image (luminance contrast?) two solid colors but the others gradients?}

%\fs{The point of this figure is to show the primary types of contrast - hue, sat and ,value, applied to data. People understand the verbal description of contrast types but it I find that in order to get buy in you need to illustrate the concepts on data.
%I am always surprised when I get asked things like what is a muted color.what are the cool colors, etc. This figure was to lay the foundation for understanding what those mean. Yes, they all have multiple types of contrast but that cant be avoided.}

%\km{If the last image is a combination of contrasts, why not show \fast? }

%\fs{Fast is a compromise and thus does not present as clear an example of the impact of multiple types of contrast.}

%\km{And what are the images supposed to demonstrate? Are some showing detail not seen in the others?}

%\fs{to some degree yes but the point is to help them make the translation between adjusting the characteristics of a colormap and how that impacts what you see.}

%\km{That is really my confusion. I get that the pictures are supposed to show me how the characteristics impact what I see, but apart from different colors I see pretty much the same thing in each picture. Maybe if it was explicitly said what is different about each one that would help.}

%\fs{None of these issues are hills I want to die on. Happy to make changes. It would be easier to discuss as we approach the topic differently.}

%\km{Generally, I liked reading your discussion of the different types of contrast. This was new to me and I'm very curious about I would apply this. The problem for me (and I think I am part of the target audiance) is that the picture never brought it together. I look at it, say, yup the colors are different, but otherwise I don't immediately see how one might be ``better'' than another. At the very least, we should be able to point to the right image and identify something better than each other image independently, but I don't clearly see that.}


Selecting a colormap best suited to specific tasks, datasets, and data distributions is key to maximizing the capability of color to translate data; however, it is a time-consuming process.

Creating custom colormaps requires time and color expertise. Even scientists who have taken our color tutorials report that while they understand the value of custom colormaps and have devoted time to customizing maps for their data, they report that it is a challenging process that often does not produce improvements on the default or other readily available options.


%\km{Is the use of the word ``hue'' here consistent with how it is used elsewhere in the paper? Throughout the paper, we consider hue as one color property in a hue-saturation-luminance model. The linear maps described above (sometimes) change only saturation and luminance, leaving hue alone. Thus, when this paragraph states that colormaps translate data only through contrast of hues, that would mean that a linear map provides no data because it has no change of hue. Does the paragraph more generally mean perceptual differences in color rather than just differences in hue?}

%\fs{Yes, it is confusing. In my community hue refers  hue as you describe it but is also how we speak of individual colors, especially ones that are nuanced and without a specific name. I changed hue to colors and tried to clarify. If you have another suggestion, let me know.}



Ware tested the internal contrast levels of commonly used colormaps.
The results, shown in Figure~\ref{Ware}, graph the amount of contrast across the colormaps.
It illustrates the uneven contrast distribution of \huewheel, the more consistent higher level of contrast in both \blueorange and \extendedcoolwarm (an alternative to \blueorange using extended hues from \coolwarm), and the shortcomings of other standards.



Colormaps with high discriminatory power employ multiple types of contrast across the map.
Looking at Figure~\ref{Larsen3}, \huewheel relies on hue and simultaneous contrast, \coolwarm narrows the hue range but gains contrast by adding two cropped luminance ranges.
Fast, like \huewheel includes a wide range of hue, a range of saturation levels, two robust luminance ranges, and complimentary contrast created by the inclusion of blue and orange hues.
When constructing colormaps there are always trade-offs about which types and how much contrast should be included.
The goal is to maximize the contrast between the internal hues, while maintaining harmony across the colormap.



%For this reason, default colormaps need to be constructed to address the needs of a wide range of data types and distributions. Given that color is our primary means of revealing the data, the default colormap is a critical component of any visualization program.

%The \huewheel colormap provided adequate discriminatory power when the range of data is small and detail is not required. However, as the data grows, the discriminatory power within colormaps needs to be increased to keep pace.

The most common request we receive from scientists is higher feature resolution, a property driven by the internal contrast levels within the colormap.
Larger numbers of control points enable one to build higher levels of internal contrast; however they disrupt the ease of adjusting the map to align with specific data.
\fast has nine control point, balancing these conflicting interests.
Future work includes addressing this trade-off by an automating the rescaling on the control point distribution.

%It is worth noting that colormaps with larger numbers of control points are able to attain greater discriminatory power due to the greater control of hues sequences. However, here we have limited the number of control points as they make it difficult to adjust the hue distribution to meet the needs of your data while maintaining the even progression of contrast distribution.


\section{CONSTRUCTING A NEW DEFAULT}
The origins of the new default color map arise from a collaboration between climate scientists, visualization experts, and visual artists~\cite{Samsel2015}.
The team found that the existing default colors do not reveal enough detail within the high-resolution data they use.
This collaboration engendered the \blueorange colormap (Figure~\ref{fig:design:blueorange}), which better satisfies the needs of the climate scientists~\cite{Samsel2015:SC}.
This colormap is built on the same principles as the \coolwarm colormap (Figure~\ref{fig:design:coolwarm}) but expanded the internal contrast incorporating longer paths through hue, saturation, and luminance, a principal well documented for increasing internal contrast \cite{Ware2023}.


\begin{figure}[t]
\includegraphics[width=\columnwidth]{Final_Pics/30F_combo.png}
\centering
\caption{CCC-Tool's colormap construction interface showing the control points of \fast. Top to bottom: HSL control points; LAB control points and the optimization function we used to determine the level of local discriminatory power.}
\label{CCC1}
\end{figure}

\begin{figure*}[t]
  \centering
  \includegraphics[width=\textwidth]{Final_Pics/Compare22.png}
  \caption{
    Iterative design from the \blueorange colormap (left) to our final design of \fast (right).
    The impact of each iteration is demonstrated on two types of data: streamlines of wind from a fire simulation, and volumetric data of smoke from the same fire simulation.}
\label{fig:iterations}
\end{figure*}


The \blueorange colormap improves on the discriminating power of \coolwarm by increasing the range of all available color channels without violating robustness to colorblindness.
First, the brightness range is expanded by dropping the brightness at each end.
This increases the luminance profile, which is known to be the most powerful channel for visual discrimination, particularly for high-frequency data \cite{Ware2019}.
The hue range is also expanded by
\begin{inparaenum}[(1)]
\item mixing green into the light cool colors,
\item mixing yellow and orange into to light warm range, and
\item moving the darker colors toward purple and maroon.
\end{inparaenum}
The saturation is also significantly increased across the color map to bring more vibrancy and to more clearly distinguish between the hues.
User studies like that in Figure~\ref{Ware}
show the \blueorange colormap to be better than the original \coolwarm colormap and overall one of the best performing colormaps \cite{Ware2017,Ware2019,Turton2017}.



The success of the \blueorange colormap, which shares features with \coolwarm, suggests that improvements could be made.
A reasonable impulse would be to simply establish \blueorange as the default ParaView colormap.
However, the \blueorange colormap design comes from a particular collaboration with climate scientists studying ocean temperature and is thus developed specifically for their needs.
Because it was created with a narrow focus of customers, it has some characteristics that make it unsuitable for more general application.


Colormap construction is an iterative process.
We moved through over 50 versions to arrive at \fast.
Figure~\ref{CCC1} contains the CCC-Tool interfaces~\cite{Nardini2021} used in the process of iteration.
This tool simplifies many processes involved in building colormaps including adjusting the control points in HSV (top), comparing the HSV coordinates to the control point graph in LAB space (middle), checking for equal and smooth distributions of the hues, and turning to the Optimization tab to check the local speed and contrast distribution (bottom).
A change in one section of the map often impacts another, driving the need for another iteration.
%in which the  section of CCC-Tool and by comparing the HSV space control points which enable manipulation according to artistic color theory and LAB space, examining the plots for smoothness. Then the map is applied to four data sets: points, streamlines, volumetric data and a combination.

%\fs{Ken, I think this is redundant but take a look.}
%\km{Agreed. This does feel repetative.}
%Figure~\ref{CCC1} shows the control points of \fast in the CCC-Tool\cite{Nardini2021} interface. We start by selecting and adjusting the control points in HSV space (left) as there the hues are intuitively adjustable. Once we are close to a the desired colormap, its control points are reviewed in CIElab (middle) which is useful for tuning the perceptual consistency of the map. In order to check the strength and distribution of the discriminatory power we review in the optimization metrics (bottom) section.


%\km{This paragraph also sounds repetative and it feels very awkwardly phrased. I think it will be more clear to just jump into the description of the \blueorange edits.}
%Implementing the \textit{Criteria} exposes the inherent linkage and impacts. For example increasing smoothness decreases feature resolution but is important for minimizing artifacts. The iterative process involves balancing the smoothness, equal distribution of luminance, smooth hue transitions, as well as identify a path through turquoise and fuchsia, awkward transitions in digital colorspace. Like yellow, in their pure form they are lighter crisp. When darkened, they quickly become muddy, obscuring the hue.


%\begin{figure}[htb]
%\centering
%\includegraphics[width=\columnwidth]{pics/Ocean2.png}
%\caption{Demonstration of the smoothness of colormaps using E3SM ocean temperature data.
    %The \blueorange colormap (middle) has a sharp ``peak'' at the center white point where the luminance transitions from increasing to decreasing.
    %Our final \fast colormap (right) smooths out this middle point.
%\label{fig:smoothness}
%\end{figure}


%\begin{figure}[htb]
 % \centering
 %%% \includegraphics[width=.15\textwidth]{shading-fast}
 % \caption{
    %%The colors at the ``dark'' ends of the \coolwarm colormap (left) are kept bright enough to easily discern shading.
    %The \blueorange colormap (middle) becomes too dark perceive shape.


% \begin{figure*}[t]
%  \centering
%  \includegraphics[width=\textwidth]{Final_Pics/TheHow_H.png}
 % \caption{Here is the CCC-Tool interface, adjustments can be made to the hue, saturation and luminance of your colormap as described below.
 %   }
%\label{fig:HOW}
%\end{figure*}


%Figure~\ref{fig:CCC1} illustrates the process of modifying colormaps.


\blueorange, produces a strong white focal point in its center as demonstrated in Figure~\ref{fig:iterations}, on the left. %generated by the low saturation level.
It is illustrated on data in Figure~\ref{fig:iterations}.
Although valuable for designating the middle point of the data, it is imperfect for general data and violates the smoothness characteristic we desire.
To correct for this, we lowered the luminance at that point and raised the saturation slightly as shown in the center of Figure~\ref{fig:iterations}.
\fast, on the right, is the compromise.
Ideally we would make a perfectly smooth transition in the center but this lowers the discrimination power in the mid-section.
The values on the end section are a compromise between discriminatory power and clarity when shadows are present.
The exchanges are further detailed in Figure~\ref{fig:Matrix}.



%The middle section, shows the decrease in luminance, to decrease the impact on 3D shading as shown in Figure~\ref{fig:3d-shading}.
%This problem is corrected by trimming, brightening, and raising the saturation of the dark ends of the map.
%Again, we are making a compromise leaning more toward discriminability, making the shading just visible in the worst case of coloring everything by the darkest color.
%The right-hand section illustrates the increase of saturation in the mid-point to eliminate the white which is problematic when using a white background, common for publications.

%Based on these needed adjustments to the \blueorange colormap, we constructed many candidate maps.
%Figure~\ref{fig:iterations} renders these maps on data, documenting the changes and illustrating
%the impact.

These maps were evaluated using the $\Delta$E discriminability metric in CCC-Tool shown in the bottom panel of Figure~\ref{CCC1}. Figure \ref{fig:iterations} shows the application of these candidate colormaps on streamlines (top) and volumetric data (bottom).
Starting on the left, one can see that \blueorange produces saturated, detailed renderings with a clear delineation between the cool and warm sections.
The first goal was to lower the center focal point and equalize the uniformity of the transitions.

\begin{figure*}[t]
\centering
\includegraphics[width=\textwidth]{Final_Pics/TheMatrix.png}
\caption{Left to right are five datasets: ocean kinetic energy; wildfire wind; magnetic reconnection; combustion simulation; wildfire smoke. They are organized by the data characteristics: the two left columns contain data spanning the full range, relatively evenly; the middle column is noisy data that spans the full range but is concentrated in the mid-range; the right two columns contain data concentrated on the low end, 2D and 3D, in column four and five respectively. }
\label{fig:Matrix}
\end{figure*}


Next, we sought to further smooth the center range as well as experiment with lightening the end values to address the shading concerns.
We also added a yellow tint to the center values to prevent bright colors from blending into white backgrounds.
Both changes are shown in the middle of Figure~\ref{fig:iterations}.


However, the discriminatory power of this colormap was significantly compromised from these previous changes. We tried increasing the saturation across the colormap and extending the warm hues toward purple. Here the transition toward fushsia became problematic. To compensate, we increased the saturation again, removed the purple and shifted the turquoise region toward the center to provide the needed discrimination, resulting in the final \fast colormap shown on the right of Figure~\ref{fig:iterations}.

These candidate colormaps manifest different balances of our criteria: the luminance range to balance discriminability and 3D shading, different luminance adjustments at the center point to balance uniformity and smoothness, and different hue ranges to balance discriminability and order.


%%\centering
%\includegraphics [width=\textwidth]{Final_Pics/Shadow_lights_H.png}
%\caption{Left to right, \coolwarm, \coolwarm with light added, \fast, \fast with light added.}
% \label{fig:3d-shading}
%\end{figure*}

Colormaps for 3D surfaces have an added complexity.
3D forms are principally defined by shading, but the brightness of a colormap can interfere with the interpretation of shading.
%Figure~\ref{fig:Matrix}, right column, illustrates the issue.
%In the mid-value range of the colormap they shift the value but do not disrupt our ability to see the forms.
%In the low and high ends of the colormap, where the hues are the dark, shadows can prevent us from seeing the shape altogether.
%Given that luminance is the most powerful contrast type, the sacrifice is significant.
%Figure~\ref{Ware} details the impact on the discriminatory power.
The right column in Figure~\ref{fig:Matrix} illustrates the interference of shading and colors in \coolwarm, \blueorange, \fast, and other colormaps.
\coolwarm, second row, addresses this issue by not including darker blues and reds, but it does so at a cost of lowering the discriminatory power.
%In the \coolwarm the 3D forms are clearer than but in visualizations showing the full range of the data, detail is lost.
In contrast, the \extendedcoolwarm and \blueorange colormaps, third and fourth rows, have colors dark enough to completely hide the shape of objects they are applied to.
As a compromise, \fast employs a wider span of the luminance range than \coolwarm but less than \extendedcoolwarm or \blueorange.
%When using \fast, one can add a default light under the light inspector function, requiring only a box check, a much easier task than trying to increase the internal luminance range as that would require adding and adjusting individual control points.


Finally, a sequence of control points was chosen for a piecewise-linear interpolation of colors in CIELAB space with a preference to minimize their number.
In practice, users sometimes wish to modify a colormap to their purpose.
For example, users may wish to adjust the colors to highlight particular regions of their scalar data.
This cannot be done easily with larger numbers of control points, so we removed any control points where interpolation produces nearly identical results.
Our final design has nine control points as it is the minimum needed to produce a smoothly transitioning map that moves through the hues we have selected.



\section{USER FEEDBACK}

As we neared completion of the new colormap design, the development team wanted feedback from current users about these changes before being affected by them.
Sandia National Laboratories has a strong ParaView user base and an active support team for them.
The ParaView support team sent an email to the Sandia ParaView users informing them of planned changes and welcoming any feedback.
The email elicited feedback with the following open-ended text: ``The ParaView team is debating changing the default, as shown below. Note that users can always change back to our current map and palette. If anyone has any opinions on changes, please send your thoughts back to us.''
This was followed by a set of images comparing the \coolwarm colormap and an early version of \fast along with a potential change in background shade that was being considered.

Of the roughly 800 users receiving the email, 18 responded back with comments about the change of the default colormap from Cool to Warm to Fast.
Of these, 15 expressed a clear preference for the new colormap.
We made no attempt to quantify the rating of responses, but they ranged from very favorable (e.g., ``I’ll emphatically vote for the neutral gray background and FAST colormap.'' and ``I like the FAST colormap. Seems like it uses more of the color spectrum whereas the other only uses red, white, blue.'') whereas others only had a slight preference (e.g., ``I don’t have a strong opinion on the default color map; I would maybe lean towards the new one.'' and ``The new one does look a bit better, but the old one isn’t too bad either.'').

Of the remaining 3 respondees, 2 did not express a strong preference.
One stated, ``The new/proposed color map seems fine, the minima/maxima seem a little dark to me personally.''
One respondee disapproved of any change but also would use neither colormap: ``I would never vote to change something that is working.  I also never ever use the default color map. I vote do not change.''
Only one respondee gave a preference to the \coolwarm colormap citing issues with banding on some displays: ``The one thing I’ll point out is that in the attached image, there appears to be more banding of colors resulting in sharper steps visually (particularly in the bottom half of the image). Probably this is just an artifact, but aside from the increased contrast, it makes me prefer the images [of \coolwarm{}] to the ones [of \fast{}].''

Although no formal study has been done, we see this overall as a clear general preference for the new colormap.


\section{PERCEPTUAL EVALUATION}

Although we have not yet had a chance to perform formal human subject studies, we are confident that \fast will outperform its predecessor, \coolwarm, in terms of discriminability.
In particular, \fast has a higher $\Delta$E discriminability metric.
As measured by CCC-Tool~\cite{Nardini2021}, \coolwarm has an average local CIE$\Delta$E2000 discriminability score of 120 whereas \fast has a score of 174. Other discriminability metrics similarly show improvements with \fast.
All that said, we recognize that \fast%
%, shown in Figure \ref{Larsen3},
likely performs less well with respect to discriminability than the \blueorange colormap it is based on as \blueorange includes a larger luminence range, being darker on the ends and going to white in the center.
These changes were necessary in order to adjust for the smoothness and robustness to shading on 3D surfaces.

The \coolwarm colormap was designed about 15 years ago to move away from the \huewheel colormap and its rainbow colors because of the strong evidence at the time of its poor perceptual properties~\cite{Rogowitz1998,Borland2007,Ware1988,Light2004}.
In the interim, multiple colormaps based on the hues of the rainbow that correct some of the problems of the \huewheel have been designed.
More recent research suggests that added hues and more nameable colors can assist in color differentiations that are not otherwise explained by our perceptual color models \cite{Reda2021}.
This leads some to suggest that perceptually correct colormaps based on rainbow colormaps might be favorable \cite{Ware2023}.
Although the \fast colormap does not incorporate all rainbow hues, it does improve dramatically over the hues provided by \coolwarm.

\fast also has more namable colors than its \coolwarm predecessor.
Using the color categorization tendency metric proposed by Reda \cite{Reda2022}, \fast once again exceeds \coolwarm.
Using a color name similarity threshold of 0.6 (as was used by Reda), \coolwarm has a categorization tendency metric of 310 whereas \fast scores 369.
That said, \fast could likely be improved further by completing the rainbow with distinctive green hues (much like the \turbo colormap~\cite{Mikhailov2019} does).
However, these are all recent observations deserving more study, particularly for effects beyond discriminability.
Thus, we are not ready to loop back around to the full hues of a rainbow.


\section{CONCLUSION}

Our final iteration of the new colormap, which we dub ``\fast,''\footnote{The name \fast is meaningless, but was chosen as it is reminiscent of other colormap names like \colormap{Jet} and \turbo.} is demonstrated in Figure~\ref{Larsen3} as well as numerous other figures in this paper.
The colors are listed in Table~\ref{tab:colors}.
This colormap is provided as one of the available colormaps in ParaView~5.12 and will become the default colormap in ParaView~5.13.

\definecolor{fast0}{RGB}{ 14,  14, 120}
\definecolor{fast1}{RGB}{ 62, 117, 207}
\definecolor{fast2}{RGB}{ 91, 190, 243}
\definecolor{fast3}{RGB}{175, 237, 234}
\definecolor{fast4}{RGB}{229, 241, 196}
\definecolor{fast5}{RGB}{244, 213, 130}
\definecolor{fast6}{RGB}{237, 158,  80}
\definecolor{fast7}{RGB}{204,  90,  41}
\definecolor{fast8}{RGB}{150,  20,  30}

\newcommand*{\colordemo}[1]{\colorbox{#1}{\phantom{X}}}

\begin{table}[t]
  \centering
  \caption{
    Color values used for the \fast colormap control points.
    These colors are intended to be interpolated in the CIELAB color space.
    Note that these control points are not evenly distributed.
    Pay mind to the interpolant x.
  }
  \label{tab:colors}
  \begin{tabular}{r@{\quad~( }r@{, }r@{, }r@{ )\quad~( }r@{, }r@{, }r@{ )\quad~}c}
    \toprule
    \multicolumn{1}{c@{\quad~\phantom{( }}}{x} & \multicolumn{3}{c@{\phantom{ )}\quad~\phantom{( }}}{RGB} & \multicolumn{3}{c@{ \phantom{)}\quad~}}{CIELAB} \\
    \midrule
    0.00 &  14 &  14 & 120 &   14.3 &  39.5 & -57.3 & \colordemo{fast0} \\
    0.17 &  62 & 117 & 207 &   49.9 &  11.4 & -51.5 & \colordemo{fast1} \\
    0.30 &  91 & 190 & 243 &   73.2 & -13.3 & -35.1 & \colordemo{fast2} \\
    0.43 & 175 & 237 & 234 &   89.7 & -19.9 &  -4.8 & \colordemo{fast3} \\
    0.50 & 229 & 241 & 196 &   93.2 & -11.3 &  20.4 & \colordemo{fast4} \\
    0.59 & 244 & 213 & 130 &   86.1 &   0.4 &  44.8 & \colordemo{fast5} \\
    0.71 & 237 & 158 &  80 &   71.6 &  21.9 &  51.5 & \colordemo{fast6} \\
    0.85 & 204 &  90 &  41 &   52.1 &  42.6 &  48.5 & \colordemo{fast7} \\
    1.00 & 150 &  20 &  30 &   32.0 &  51.4 &  30.6 & \colordemo{fast8} \\
    \bottomrule
  \end{tabular}
\end{table}

Revisiting the criteria presented at the beginning of this paper, evaluations and user feedback show the advantages of \fast over \coolwarm and other standard defaults. Figure~\ref{fig:Matrix} provides comparisons of the criteria across five data sets.


%\begin{figure}
%\includegraphics[width=\linewidth]{pics/Larsen2.png}
%\caption{Combustion simulation (Larsen, LLNL) of \coolwarm (left) and \fast (right) colormaps demonstrating to discriminatory power in the mid-range of data values.}
%\label{Larsen}
%\end{figure}


\begin{itemize}

\item \emph{Discriminative power} --
  \fast performs better on every color discriminability metric that we have available.
\item \emph{Uniformity} --
  The previous \coolwarm colormap has very little luminance change in its center leaving a region of colors that tend to get washed out (see Figures \ref{Larsen3} and \ref{fig:Matrix}).
  \fast retains more luminance variation at its apex to help maintain a uniform perceptual change in that region.
\item \emph{Smoothness} --
  \fast sacrifices some smoothness at the center for gain in discrimination and uniformity, but the smoothness is close to \coolwarm and much better than \blueorange.
\item \emph{Order} --
  \coolwarm and \fast use the same cues of luminance and warmth for color order.
\item \emph{Robustness to shading on 3D surfaces} --
  \fast allows the end colors to become darker for greater discriminability.
  This makes shapes a bit harder but still possible to discern in the worst case scenario of values all at one end of the colormap range (see Figure~\ref{fig:Matrix}, right column).
  Although dark surfaces can be reveled with brighter lighting, such bright colors could wash out light colors.
  Requiring customized lighting is just pushing the problem back on the user again, so we discount this solution.
  It is also conceivable that changes in lightness could obfuscate the shape.
  Research for such an effect is lacking, but anecdotally we have not encountered such an occurrence.
\item \emph{Robustness to colorblindness} --
  Colorblindness was always kept in mind when designing \fast.
  Figure~\ref{fig:colorblindness} shows that \fast responds just as well to common forms of colorblindness as does \coolwarm.
\item \emph{Aesthetically pleasing} --
  Aesthetics are notoriously difficult to measure with any accuracy.
  However, voluntary responses from ParaView users suggest a preference for \fast.

\end{itemize}



With the introduction of \fast as the default colormap for ParaView, we make a significant improvement in the readability of colors in many visualizations produced. We are proud to have the opportunity to have such a broad impact on the scientific community.

\begin{figure}[htb]
  \centering
  \begin{tabular}{cc}
    \includegraphics[width=.44\linewidth, height=5mm]{map-cool-to-warm} & \includegraphics[width=.44\linewidth, height=5mm]{map-fast} \\
    \includegraphics[width=.44\linewidth, height=5mm]{map-protanopia-cool-to-warm} & \includegraphics[width=.44\linewidth, height=5mm]{map-protanopia-fast} \\
    \includegraphics[width=.44\linewidth, height=5mm]{map-deurteranopia-cool-to-warm} & \includegraphics[width=.44\linewidth, height=5mm]{map-deurteranopia-fast}
  \end{tabular}
  \caption{
    Colorblindness simulation of \coolwarm (left) and \fast (right) colormaps.
    The top row is the original colors.
    The middle row is the colors simulated for protanopia.
    The bottom row is the colors simulated for deurteranopia.
  }
  \label{fig:colorblindness}
\end{figure}

\section{ACKNOWLEDGMENT}

The authors wish to thank the ParaView software development team at Kitware, Inc. for assisting in making these changes to the software. We also wish to thank those in the ParaView community who provided the necessary feedback to guide our designs. We also wish to acknowledge the contributions made by the Data Science at Scale, LANL~\cite{SciVisColor}, for their contributions and support for the underlying color research and Khairi Reda for help with namability evaluations of colormaps.

This work was supported in part by the U.S. Department of Energy (DOE) RAPIDS SciDAC project under contract number DE-AC05-00OR22725. This paper describes objective technical results and analysis. Any subjective views or opinions that might be expressed in the paper do not necessarily represent the views of the U.S. Department of Energy or the United States Government. This work was done in part at Sandia National Laboratories, which is a multi-mission laboratory managed and operated by National Technology and Engineering Solutions of Sandia, LLC, a wholly owned subsidiary of Honeywell International Inc., for the U.S. Department of Energy's National Nuclear Security Administration under contract DE-NA0003525.

We would like to thank all of the scientists who lent their data and provided feedback on the colormaps. The data was provided by scientists at US DOE Laboratories including: M. Petersen, MPAS-Ocean, LANL; R. Linn, LANL, wildfire; W. Daughton, LANL, magnetic reconnection; M. Larsen, LLNL, combustion simulation.


\bibliographystyle{IEEEtran}
\bibliography{Fast_ParaView}

\begin{IEEEbiography}{Francesca Samsel}{\,} is a research scientist in the Visualization Group at The Texas Advanced Computing Center, University of Texas at Austin. She received an M.F.A. from the University of Washington and a B.F.A. from California College of Art. Prior to turning her attention to scientific visualization she taught sculpture and design in the Art Department of Fordham University at Marymount. Her research focuses on expanding the visual language used to encode scientific data, which started with her work on color, as well as experimenting with forms of interactive and physicalized data. Contact her at fsamsel@tacc.utexas.edu.
\end{IEEEbiography}

\begin{IEEEbiography}{W. Alan Scott}{\,}is Sandia National Laboratories' ParaView Support Manager.  He received an MS degree in computer science from Utah State University in 1992, focusing on computer architectures, parallel processing, compiler design, and graphics.  His current interests include ParaView functionality and user experiences.  Contact him at wascott@sandia.gov.
\end{IEEEbiography}

\begin{IEEEbiography}{Kenneth Moreland,}{\,} with Oak Ridge National Laboratory, is a senior member of IEEE.
  He received MS and Ph.D. degrees in computer science from the University of New Mexico in 2000 and 2004, respectively.
  Dr. Moreland specializes in large-scale visualization and graphics and plays an active role in the development of several HPC products including ParaView, VTK, IceT, Catalyst, and VTK-m.
  His current interests include the design and development of visualization algorithms and systems to run on multi-core, many-core, and future-generation computer hardware.
  Contact him at morelandkd@ornl.gov.
\end{IEEEbiography}

\end{document}

